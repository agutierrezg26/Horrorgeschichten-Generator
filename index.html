<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Horrorgeschichten-Generator (A2)</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
<style>
body {
  font-family: "Segoe UI", sans-serif;
  background-color: #1b1b1b;
  color: #fff;
  text-align: center;
  padding: 20px;
}

h1 {
  font-family: 'Creepster', cursive;
  color: #ff5555;
  font-size: 4rem;
  margin-bottom: 10px;
}

select, button {
  font-size: 1rem;
  padding: 10px;
  margin: 8px;
  border-radius: 8px;
  border: none;
  max-width: 90%;
}

button {
  background-color: #ff3333;
  color: white;
  cursor: pointer;
  transition: 0.3s;
}

button:hover {
  background-color: #ff6666;
  transform: scale(1.03);
}

.section {
  background: #111;
  border-radius: 10px;
  padding: 15px;
  margin-top: 20px;
  width: 90%;
  max-width: 700px;
  margin-inline: auto;
  text-align: left;
  opacity: 0;
  transition: opacity 0.8s ease-in-out;
}

#einfuhrung { color: #fff; }
#entwicklung { color: #ccc; margin-top: 10px; display: none; }
#konsequenz { color: #ccc; margin-top: 10px; display: none; }
.option-buttons { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 20px; }
.option-buttons button { width: 90%; max-width: 500px; background-color: #333; }
.option-buttons button:hover { background-color: #555; }
#endgeschichte { background: #222; border-radius: 10px; padding: 15px; margin-top: 20px; width: 90%; max-width: 700px; margin-inline: auto; min-height: 150px; overflow-y: auto; text-align: left; display: none; }

@media (max-width: 600px) {
  h1 { font-size: 1.8rem; }
  select, button { font-size: 0.9rem; padding: 8px; }
  .section, #endgeschichte { font-size: 0.9rem; }
  .option-buttons button { font-size: 0.9rem; }
}
</style>
</head>
<body>

<h1>üïØÔ∏è Horrorgeschichten-Generator</h1>

<p></p>

<select id="personSelect"></select>
<select id="ortSelect"></select>
<select id="ereignisSelect"></select>

<br>
<button onclick="einfuhrung()">Wie beginnt die Geschichte?</button>

<div class="section" id="einfuhrung">
  <div id="einfuhrungText"></div>
  <div id="entwicklungButtonContainer" style="display:none; margin-top:10px;">
    <button onclick="zeigeEntwicklung()">Wie geht es weiter?</button>
  </div>
</div>

<div class="section" id="entwicklung">
  <div class="option-buttons" id="entwicklungButtons"></div>
</div>

<!-- Bot√≥n intermedio para Konsequenz, siempre visible pero inicialmente invisible con opacidad -->
<div id="konsequenzButtonTriggerContainer" style="opacity:0; margin-top:20px; text-align:center;">
  <button id="showKonsequenzBtn">Und nun?</button>
</div>

<div class="section" id="konsequenz">
  <div class="option-buttons" id="konsequenzButtons"></div>
</div>

<div id="endgeschichte">

  <div id="finalText"></div>
</div>

<script>
// Historias simplificadas A2
const geschichten = [
  {
    person: "eine Sch√ºlerin", pronomen: "sie", ort: "in einem alten Haus", ereignis: "h√∂rte ein seltsames Ger√§usch",
    einfuhrung: "Es war eine kalte Nacht. Alles war still.",
    entwicklungen: [
      "sie √∂ffnete die T√ºr langsam. Drinnen war es dunkel.",
      "sie sah ein altes Buch auf dem Tisch. Es war sehr alt.",
      "sie h√∂rte Schritte hinter sich. Niemand war da."
    ]
  },
  {
    person: "ein junger Mann", pronomen: "er", ort: "im dunklen Wald", ereignis: "bemerkte, dass die T√ºr offen war",
    einfuhrung: "Der Wald war dunkel. Er h√∂rte den Wind in den B√§umen.",
    entwicklungen: [
      "er ging den Weg entlang. Er h√∂rte ein Ger√§usch.",
      "er sah einen Schatten zwischen den B√§umen.",
      "er fand eine kleine H√ºtte. Die T√ºr war offen."
    ]
  }
];

// Consecuencias para el paso final
function getConsequences(pronomen) {
  return [
    capitalizeFirstLetter(pronomen) + " war sehr √ºberrascht und wusste nicht, was passieren w√ºrde.",
    capitalizeFirstLetter(pronomen) + " hatte Angst, aber ging vorsichtig weiter.",
    capitalizeFirstLetter(pronomen) + " h√∂rte ein Ger√§usch und blieb stehen."
  ];
}

// Poblar selects
const personSelect = document.getElementById("personSelect");
const ortSelect = document.getElementById("ortSelect");
const ereignisSelect = document.getElementById("ereignisSelect");

geschichten.forEach(g => {
  if([...personSelect.options].every(o => o.value !== g.person)) personSelect.add(new Option(capitalizeFirstLetter(g.person), g.person));
  if([...ortSelect.options].every(o => o.value !== g.ort)) ortSelect.add(new Option(g.ort, g.ort));
  if([...ereignisSelect.options].every(o => o.value !== g.ereignis)) ereignisSelect.add(new Option(g.ereignis, g.ereignis));
});

let story = "";

// Capitalizar primera letra
function capitalizeFirstLetter(text) {
  if(!text) return "";
  return text.charAt(0).toUpperCase() + text.slice(1);
}

// Einfuhrung
function einfuhrung() {
  const person = personSelect.value;
  const ort = ortSelect.value;
  const ereignis = ereignisSelect.value;
  const hist = geschichten.find(h => h.person === person && h.ort === ort && h.ereignis === ereignis);
  if(!hist) { alert("Keine passende Geschichte gefunden."); return; }

  story = capitalizeFirstLetter(hist.einfuhrung) + " " + capitalizeFirstLetter(hist.person) + " " + hist.ort + " " + hist.ereignis + ".";
  document.getElementById("einfuhrungText").innerText = story;
  document.getElementById("einfuhrung").style.opacity = 1;

  setTimeout(() => document.getElementById("entwicklungButtonContainer").style.display = "block", 5000);
}

// Entwicklung
function zeigeEntwicklung() {
  const entwicklungDiv = document.getElementById("entwicklung");
  entwicklungDiv.style.display = "block";
  entwicklungDiv.style.opacity = 1;

  const container = document.getElementById("entwicklungButtons");
  container.innerHTML = "";

  const hist = geschichten.find(h => h.person === personSelect.value && h.ort === ortSelect.value && h.ereignis === ereignisSelect.value);
  hist.entwicklungen.forEach(text => {
    const btn = document.createElement("button");
    btn.innerText = capitalizeFirstLetter(text);
    btn.onclick = () => {
      story += " " + capitalizeFirstLetter(text);
      document.getElementById("finalText").innerText = story;
      container.querySelectorAll("button").forEach(b => { b.disabled = true; if(b!==btn) b.style.opacity=0.5; });
      btn.style.backgroundColor = "#ff4444";

      // Mostrar bot√≥n intermedio de Konsequenz con fade-in
      const btnContainer = document.getElementById("konsequenzButtonTriggerContainer");
      btnContainer.style.transition = "opacity 0.8s";
      btnContainer.style.opacity = 1;
    };
    container.appendChild(btn);
  });
}

// Mostrar consecuencias al hacer clic en "Und nun?"
document.getElementById("showKonsequenzBtn").onclick = () => {
  const hist = geschichten.find(h => h.person === personSelect.value && h.ort === ortSelect.value && h.ereignis === ereignisSelect.value);
  showConsequences(hist.pronomen);
};

// Consecuencia final
function showConsequences(pronomen) {
  const konsequenzDiv = document.getElementById("konsequenz");
  konsequenzDiv.style.display = "block";
  konsequenzDiv.style.opacity = 1;

  const container = document.getElementById("konsequenzButtons");
  container.innerHTML = "";

  const options = getConsequences(pronomen);
  options.forEach(text => {
    const btn = document.createElement("button");
    btn.innerText = text;
    btn.onclick = () => {
      story += " " + text;
      document.getElementById("finalText").innerText = story;
      document.getElementById("endgeschichte").style.display = "block";
      document.getElementById("endgeschichte").style.opacity = 1;

      container.querySelectorAll("button").forEach(b => { b.disabled = true; if(b!==btn) b.style.opacity=0.5; });
      btn.style.backgroundColor = "#ff4444";
    };
    container.appendChild(btn);
  });
}
</script>

</body>
</html>
